# 1. 生命周期

## 1.1 旧生命周期

- ![image-20220706161526924](https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20220706161526924.png)

1. 初始化阶段: 由ReactDOM.render()触发---初次渲染
   1. `constructor()`
   2. `componentWillMount()`：组件将要挂载
   3. `render()`：组件渲染
   4. `componentDidMount()`：组件挂完毕
2. 更新阶段: 由组件内部this.setSate()或父组件重新render触发
   1. `shouldComponentUpdate()`
   2. `componentWillUpdate()`
   3. `render()`
   4. `componentDidUpdate()`
3. 卸载组件: 由ReactDOM.unmountComponentAtNode()触发
   1. `componentWillUnmount()`：



## 1.2 新生命周期

- ![image-20220706161735427](https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20220706161735427.png)

1. 初始化阶段: 由ReactDOM.render()触发---初次渲染
   1. `constructor()`
   2. **`getDerivedStateFromProps`**
   3. `render()`
   4. `componentDidMount()`：
2. 更新阶段: 由组件内部this.setSate()或父组件重新render触发
   1. **`getDerivedStateFromProps`**
   2. `shouldComponentUpdate()`
   3. `render()`
   4. **`getSnapshotBeforeUpdate`**
   5. `componentDidUpdate()`
3. 卸载组件: 由ReactDOM.unmountComponentAtNode()触发
   3. `componentWillUnmount()`

## 案例

- 组件挂完毕：`componentDidMount`

- 组件将要卸载：`componentWillUnmount`

- 初始化渲染、状态更新之后：`render`

- 卸载组件：`ReactDOM.unmountComponentAtNode(document.getElementById('test'))`

- ```js
  <body>
  	<!-- 准备好一个“容器” -->
  	<div id="test"></div>
  	
  	<!-- 引入react核心库 -->
  	<script type="text/javascript" src="../js/react.development.js"></script>
  	<!-- 引入react-dom，用于支持react操作DOM -->
  	<script type="text/javascript" src="../js/react-dom.development.js"></script>
  	<!-- 引入babel，用于将jsx转为js -->
  	<script type="text/javascript" src="../js/babel.min.js"></script>
  
  	<script type="text/babel">
  		//创建组件
  		//生命周期回调函数 <=> 生命周期钩子函数 <=> 生命周期函数 <=> 生命周期钩子
  		class Life extends React.Component{
  
  			state = {opacity:1}
  
  			death = ()=>{
  				//卸载组件
  				ReactDOM.unmountComponentAtNode(document.getElementById('test'))
  			}
  
  			//组件挂完毕
  			componentDidMount(){
  				console.log('componentDidMount');
  				this.timer = setInterval(() => {
  					//获取原状态
  					let {opacity} = this.state
  					//减小0.1
  					opacity -= 0.1
  					if(opacity <= 0) opacity = 1
  					//设置新的透明度
  					this.setState({opacity})
  				}, 200);
  			}
  
  			//组件将要卸载
  			componentWillUnmount(){
  				//清除定时器
  				clearInterval(this.timer)
  			}
  
  			//初始化渲染、状态更新之后
  			render(){
  				console.log('render');
  				return(
  					<div>
  						<h2 style={{opacity:this.state.opacity}}>React学不会怎么办？</h2>
  						<button onClick={this.death}>不活了</button>
  					</div>
  				)
  			}
  		}
  		//渲染组件
  		ReactDOM.render(<Life/>,document.getElementById('test'))
  	</script>
  </body>
  ```

- 