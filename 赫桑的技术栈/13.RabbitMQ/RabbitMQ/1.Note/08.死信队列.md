# 1. 死信的概念

![image-20220107170241730](https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20220107170241730.png)

# 2.死信的来源

- 消息`TTL (time to live)`过期
- 队列达到最大长度(队列满了，无法再添加数据到mq中)
- 消息被拒绝(`basic.reject`或`basic.nack`)并且`requeue=false.`

# 3. 死信实战

![image-20220107171908485](https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20220107171908485.png)



## 消息TTL过期

- 生产者代码

  - ```java
    public class Producer { private static final String NORMAL_EXCHANGE = "normal_exchange"; public static void main(String[] argv) throws Exception { try (Channel channel = RabbitMqUtils.getChannel()) { channel.exchangeDeclare(NORMAL_EXCHANGE, BuiltinExchangeType.DIRECT); //设置消息的TTL时间 AMQP.BasicProperties properties = new AMQP.BasicProperties().builder().expiration("10000").build(); //该信息是用作演示队列个数限制 for (int i = 1; i <11 ; i++) { String message="info"+i; channel.basicPublish(NORMAL_EXCHANGE, "zhangsan", properties, message.getBytes()); System.out.println("生产者发送消息:"+message); } } } }
    ```

  - 















































